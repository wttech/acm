group: ACL
name: acl_demo_create_user
content: |
  acl.createUser { id = "${1:acme-john-doe}"; fullName = "${2:John Doe}"; password = "${3:mysecret}"; email = "${4:john.doe@acme.com}" }.with {
    setProperty { relPath = "myprop"; value = "myvalue" }
    removeProperty { relPath = "myprop" }
    removeFromAllGroups()
    clear { path = "/content" }
    purge()
    addToGroup { groupId = "mygroup" }
    removeFromGroup { groupId = "mygroup" }
    deny { path = "/content"; permissions = ["jcr:read"]; glob = "/*"; restrictions = [:] }
    allow { path = "/content/acme"; permissions = ["jcr:read"]; glob = "/*"; restrictions = [:] }
  }
documentation: |
  Create or retrieve the user with the given ID, full name, password and email.
  The user will only be created if it does not already exist.
  Then further commands are performed for this user.
