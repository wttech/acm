group: ACL
name: acl_demo
documentation: |
  Setup the ACLs for the demo users and groups.
content: |
  boolean canRun() {
    return conditions.always()
  }
    
  void doRun() {
    log.info "ACME ACL setup started"

    def johnDoe = acl.createUser { id = "john.doe"; fullName = "John Doe"; email = "john.doe@acme.com"; password = "ilovekittens" }.tap {
      purge()
      allow { path = "/content"; permissions = ["jcr:read"] }
    }
    
    acl.createGroup { id = "acme-authors" }.tap {
      purge()
      removeAllMembers()
      addMember(johnDoe)
      allow { path = "/content/acme"; permissions = ["jcr:read", "jcr:write", "crx:replicate"] }
    }
    
    log.info "ACME ACL setup done"
  }
